[
  {
    "objectID": "Homework4-Jie Chen-st558.html",
    "href": "Homework4-Jie Chen-st558.html",
    "title": "Homework 4 - ST558",
    "section": "",
    "text": "The lapply() function in R is used to apply a function to each element of a list (or a vector, which is treated as a list of elements) and return the results in a list. It is a powerful function for iterating over lists and performing operations on each element.\nThe equivalent purrr function for lapply() is map().\n\n\n\nlapply(X=my_list,FUN=cor,method=“kendall”)\n\n\n\n(1) The purrr package provides a consistent and readable approach to functional programming in R, with well-named functions and tidy evaluation principles.\n(2) purrr offers type-specific functions (map_dbl(), map_chr(), map_int(), map_lgl() ) that ensure the output is of a specific type.\n\n\n\nA side-effect function performs operations that affect the state outside its own scope, in addition to returning a value. These operations can include modifying global variables, changing the state of objects, writing to a file, printing to the console, or performing I/O operations.\n\n\n\nR uses lexical scoping, that when it looks up the value of a name, it searches through a series of environments in a specific order. If a name is found in an environment, R stops searching and uses that value."
  },
  {
    "objectID": "Homework4-Jie Chen-st558.html#task-1-conceptual-questions",
    "href": "Homework4-Jie Chen-st558.html#task-1-conceptual-questions",
    "title": "Homework 4 - ST558",
    "section": "",
    "text": "The lapply() function in R is used to apply a function to each element of a list (or a vector, which is treated as a list of elements) and return the results in a list. It is a powerful function for iterating over lists and performing operations on each element.\nThe equivalent purrr function for lapply() is map().\n\n\n\nlapply(X=my_list,FUN=cor,method=“kendall”)\n\n\n\n(1) The purrr package provides a consistent and readable approach to functional programming in R, with well-named functions and tidy evaluation principles.\n(2) purrr offers type-specific functions (map_dbl(), map_chr(), map_int(), map_lgl() ) that ensure the output is of a specific type.\n\n\n\nA side-effect function performs operations that affect the state outside its own scope, in addition to returning a value. These operations can include modifying global variables, changing the state of objects, writing to a file, printing to the console, or performing I/O operations.\n\n\n\nR uses lexical scoping, that when it looks up the value of a name, it searches through a series of environments in a specific order. If a name is found in an environment, R stops searching and uses that value."
  },
  {
    "objectID": "Homework4-Jie Chen-st558.html#task-2---writing-r-functions",
    "href": "Homework4-Jie Chen-st558.html#task-2---writing-r-functions",
    "title": "Homework 4 - ST558",
    "section": "Task 2 - Writing R Functions",
    "text": "Task 2 - Writing R Functions\n\nWrite a basic function (getRMSE()) that takes in a vector of responses and a vector of predictions and outputs the RMSE.\n\n\ngetRMSE &lt;- function(resp, pred){\n  residual &lt;- resp - pred\n  residual_sq &lt;- residual^2\n  m_residual_sq &lt;-mean(residual_sq)\n  RMSE &lt;-sqrt(m_residual_sq)\n  return(RMSE)\n}\n\nIf a value is missing for the vector of responses (i.e. an NA is present), allow for additional arguments to the mean() function that removes the NA values in the computation.\n\n# add Ellipsis (...) Argument\ngetRMSE &lt;- function(resp, pred,...){\n  \n  residual &lt;- resp - pred\n  residual_sq &lt;- residual^2\n  # passing additional argument to mean\n  m_residual_sq &lt;-mean(residual_sq,...)\n  RMSE &lt;-sqrt(m_residual_sq)\n  return(RMSE)\n}\n\n\nspecify na.rm = TRUE to remove NA values from the computation getRMSE(resp,pred,na.rm=TRUE)\n\n\nCreate some responses and predictions.\n\n\nset.seed(10)\nn &lt;-100\nx &lt;-runif(n)\nresp &lt;-3+10*x +rnorm(n)\npred &lt;-predict(lm(resp ~x),data.frame(x))\n\n# test RMSE function \ngetRMSE(resp,pred,na.rm=TRUE)\n\n[1] 0.9581677\n\n\n\n# replace two response values with missing values (NA_real_)\nind &lt;-c(2,5)\nresp[ind] &lt;-NA_real_\n\n# test RMSE function \n# not specifying dealing with missing values\ngetRMSE(resp,pred)\n\n[1] NA\n\n# specifying dealing with missing values\ngetRMSE(resp,pred,na.rm=TRUE)\n\n[1] 0.9653433\n\n\n\nAnother common metric for evaluating predictions is mean absolute deviation\n\n\n# write a function getMAE()\ngetMAE &lt;- function(resp,pred,...) {\n  \n  residual &lt;- resp - pred\n  residual_abs &lt;- abs(residual)\n  # passing additional argument to mean\n  MAE &lt;-mean(residual_abs,...)\n  return(MAE)\n}\n\n\n# create some response and predictions\nset.seed(10)\nn &lt;-100\nx &lt;-runif(n)\nresp &lt;- 3+ 10*x +rnorm(n)\npred &lt;- predict(lm(resp ~x),data.frame(x))\n\n# test MAE function\ngetMAE(resp,pred)\n\n[1] 0.8155776\n\ngetMAE(resp,pred,na.rm=TRUE)\n\n[1] 0.8155776\n\n\n\n# replace two of the response values with missing values\nind &lt;-c(2,7)\nresp[ind]&lt;-NA_real_\n\n# test MAE function \n# specifying dealing with missing values\ngetMAE(resp,pred,na.rm=TRUE)\n\n[1] 0.8200423\n\n# without specifying dealing with missing values\ngetMAE(resp,pred)\n\n[1] NA\n\n\n\ncreate a wrapper function to get either or both metrics returned\n\n\ngetMETRICS &lt;- function(resp, pred, metrics=c(\"RMSE\", \"MAE\"),...) {\n  # check two vectors are numeric, if not print a message and exit\n  if (!is.vector(resp) || !is.numeric(resp) || !is.atomic(resp)) {\n    stop(\"Must be numeric vectors.\")\n  }\n  # check two vectors are numeric, if not print a message and exit\n  if (!is.vector(pred) || !is.numeric(pred) || !is.atomic(pred)) {\n    stop(\"Must be numeric vectors.\")\n  }\n  \n  results &lt;- list()\n  if (\"RMSE\" %in% metrics) {\n    rmse_value &lt;- getRMSE(resp, pred, ...)\n    results$RMSE &lt;- rmse_value\n  }\n  \n  if (\"MAE\" %in% metrics) {\n    mae_value &lt;- getMAE(resp, pred, ...)\n    results$MAE &lt;- mae_value\n  }\n  \n  return(results)\n}\n\n\ncreate response values and predictions and test function\n\n\n# create response values and predictions\nset.seed(10)\nn &lt;-100\nx &lt;-runif(n)\nresp &lt;-3+10*x +rnorm(n)\npred &lt;-predict(lm(resp ~x),data.frame(x))\n\n# test new function \n# Compute RMSE only\ngetMETRICS(resp, pred,metrics=\"RMSE\", na.rm = TRUE)\n\n$RMSE\n[1] 0.9581677\n\n# Compute MAE only\ngetMETRICS(resp, pred,metrics=\"MAE\", na.rm = TRUE)\n\n$MAE\n[1] 0.8155776\n\n# Compute both RMSE and MAE by default\ngetMETRICS(resp, pred, na.rm = TRUE)\n\n$RMSE\n[1] 0.9581677\n\n$MAE\n[1] 0.8155776\n\n# compute both RMSE and MAE by explicitly\ngetMETRICS(resp,pred,merics=c(\"RMSE\",\"MAE\"),na.rm=TRUE)\n\n$RMSE\n[1] 0.9581677\n\n$MAE\n[1] 0.8155776\n\n# replace two response values with missing values (NA_real_)\nind &lt;-c(2,5)\nresp[ind] &lt;-NA_real_\n\n# test new function \n# Compute RMSE only\ngetMETRICS(resp, pred,metrics=\"RMSE\", na.rm = TRUE)\n\n$RMSE\n[1] 0.9653433\n\n# Compute MAE only\ngetMETRICS(resp, pred,metrics=\"MAE\", na.rm = TRUE)\n\n$MAE\n[1] 0.822657\n\n# Compute both RMSE and MAE by default\ngetMETRICS(resp, pred, na.rm = TRUE)\n\n$RMSE\n[1] 0.9653433\n\n$MAE\n[1] 0.822657\n\n# compute both RMSE and MAE by explicitly\ngetMETRICS(resp,pred,merics=c(\"RMSE\",\"MAE\"),na.rm=TRUE)\n\n$RMSE\n[1] 0.9653433\n\n$MAE\n[1] 0.822657\n\n\n\n# test function by passing incorrect data\ndf &lt;-data.frame(resp,pred)\n\n  getMETRICS(df,pred,na.rm=TRUE)\n\n\nError in getMETRICS(df, pred, na.rm = TRUE) : Must be numeric vectors."
  },
  {
    "objectID": "Homework4-Jie Chen-st558.html#task-3---querying-an-api-and-a-tidy-style-function",
    "href": "Homework4-Jie Chen-st558.html#task-3---querying-an-api-and-a-tidy-style-function",
    "title": "Homework 4 - ST558",
    "section": "Task 3 - Querying an API and a Tidy-Style Function",
    "text": "Task 3 - Querying an API and a Tidy-Style Function\n\nUse GET() from the httr package to return info about a topic interested lately\n\n\nlibrary(httr)\nlibrary(jsonlite)\nlibrary(tidyverse)\n\n# Connect to the news API: newsapi.org\n# my API key\nsource(\"api_key.R\")\n\n# define topic interested\ntopic &lt;-\"heat wave\"\n\n# build the URL for the API request\nurl &lt;- paste0(\"https://newsapi.org/v2/everything?q=\", URLencode(topic), \"&apiKey=\", api_key)\n\n# Make the GET request\nresponse &lt;- GET(url)\n# check the structure of the response\nstr(response,max.level=1)\n\nList of 10\n $ url        : chr \"https://newsapi.org/v2/everything?q=heat%20wave&apiKey=03b9060366374f6d9459d2396315a0e8\"\n $ status_code: int 200\n $ headers    :List of 16\n  ..- attr(*, \"class\")= chr [1:2] \"insensitive\" \"list\"\n $ all_headers:List of 1\n $ cookies    :'data.frame':    0 obs. of  7 variables:\n $ content    : raw [1:82635] 7b 22 73 74 ...\n $ date       : POSIXct[1:1], format: \"2024-07-06 16:18:15\"\n $ times      : Named num [1:6] 0 0.0223 0.0323 0.0572 0.1197 ...\n  ..- attr(*, \"names\")= chr [1:6] \"redirect\" \"namelookup\" \"connect\" \"pretransfer\" ...\n $ request    :List of 7\n  ..- attr(*, \"class\")= chr \"request\"\n $ handle     :Class 'curl_handle' &lt;externalptr&gt; \n - attr(*, \"class\")= chr \"response\"\n\n\n\nparse the response\n\n\nparsed &lt;-fromJSON(rawToChar(response$content))\n\narticle_info &lt;-as_tibble(parsed$articles)\n\nprint(article_info)\n\n# A tibble: 100 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 &lt;NA&gt;      NPR   Olivi… Heat… NPR's Mich… http… https://n… 2024-06-19… \"The E…\n 2 &lt;NA&gt;      NPR   Miche… Extr… NPR's Mich… http… https://m… 2024-06-21… \"NPR's…\n 3 &lt;NA&gt;      NPR   Julia… Heat… As the hea… http… https://n… 2024-06-22… \"A maj…\n 4 &lt;NA&gt;      NPR   Joe H… Mill… A swelteri… http… https://n… 2024-06-16… \"A swe…\n 5 &lt;NA&gt;      NPR   Manol… How … A heat wav… http… https://m… 2024-07-03… \"A hea…\n 6 &lt;NA&gt;      NPR   Jorda… Nest… It’s nesti… http… https://m… 2024-07-04… \"Its n…\n 7 time      Time  Solcy… Here… Record-hig… http… https://a… 2024-06-17… \"The e…\n 8 &lt;NA&gt;      NPR   Rache… Heat… As New Eng… http… https://n… 2024-06-20… \"The U…\n 9 &lt;NA&gt;      NPR   Rache… Summ… Astronomic… http… https://n… 2024-06-20… \"Summe…\n10 &lt;NA&gt;      NPR   Diaa … A po… People in … http… https://m… 2024-06-26… \"Peopl…\n# ℹ 90 more rows\n\n\n\nwrite a function that allows user to query this API\n\n\nquery_news_api &lt;- function(subject, start_date, api_key) {\n  # Build the URL for the API request\n  url &lt;- paste0(\n    \"https://newsapi.org/v2/everything?\",\n    \"q=\", URLencode(subject),\n    \"&from=\", start_date,\n    \"&sortBy=publishedAt\",\n    \"&apiKey=\", api_key\n  )\n  # Make the GET request\n   GET(url)$content |&gt;\n     rawToChar() |&gt;\n     fromJSON() |&gt;\n     pluck(\"articles\")|&gt;\n     as_tibble()\n   \n}\n  \ndata1 &lt;- query_news_api(\"joe biden\",\"2024-06-25\",api_key)\ndata1\n\n# A tibble: 100 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 cnn       CNN   Alexa… OPIN… \"Si el pre… http… https://c… 2024-07-05… \"Nota …\n 2 &lt;NA&gt;      Free… CNN    Bide… \"CNN — Pre… http… &lt;NA&gt;       2024-07-05… \"Skip …\n 3 &lt;NA&gt;      Tomd… Micha… Incr… \"The Anglo… http… https://t… 2024-07-05… \"Where…\n 4 la-nacion La N… LA NA… Dona… \"Donald Tr… http… https://r… 2024-07-05… \"Donal…\n 5 bild      Bild  Hagen… Inte… \"Auf Georg… http… https://i… 2024-07-05… \"Auf G…\n 6 &lt;NA&gt;      ELLE… Laura… Vict… \"La nieta … http… https://h… 2024-07-05… \"El es…\n 7 info-mon… Info… Reute… Semp… \"A declara… http… https://w… 2024-07-05… \"(Reut…\n 8 &lt;NA&gt;      Baby… Babyl… Nanc… \"WASHINGTO… http… https://m… 2024-07-05… \"WASHI…\n 9 &lt;NA&gt;      [Rem… &lt;NA&gt;   [Rem… \"[Removed]\" http… &lt;NA&gt;       1970-01-01… \"[Remo…\n10 &lt;NA&gt;      Free… The H… Trum… \"Former Pr… http… &lt;NA&gt;       2024-07-05… \"Skip …\n# ℹ 90 more rows\n\ndata2 &lt;- query_news_api(\"heat wave\",\"2024-06-15\",api_key)  \ndata2\n\n# A tibble: 100 × 8\n   source$id $name author title description url   urlToImage publishedAt content\n   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  \n 1 &lt;NA&gt;      CNET  Jessi… \"Why… \"People wh… http… https://w… 2024-07-05… \"As we…\n 2 &lt;NA&gt;      Slas… feedf… \"Cal… \"Californi… http… &lt;NA&gt;       2024-07-05… \"Sign …\n 3 &lt;NA&gt;      The … Suzet… \"Goo… \"by Suzett… http… https://m… 2024-07-05… \"The M…\n 4 &lt;NA&gt;      Slas… feedf… \"Nor… \"Northern … http… &lt;NA&gt;       2024-07-05… \"Docum…\n 5 newsweek  News… Emma … \"Mil… \"Excessive… http… https://d… 2024-07-05… \"The N…\n 6 &lt;NA&gt;      WWD   Olivi… \"The… \"We tested… http… https://w… 2024-07-05… \"If yo…\n 7 cbs-news  CBS … Mary … \"\\\"D… \"The Natio… http… https://a… 2024-07-05… \"Tempe…\n 8 cbs-news  CBS … CBS N… \"Rec… \"Firefight… http… https://a… 2024-07-05… \"Watch…\n 9 &lt;NA&gt;      Skin… Gina   \"Fre… \"A free 7-… http… https://w… 2024-07-05… \"This …\n10 &lt;NA&gt;      Glob… The C… \"‘Mo… \"Environme… http… https://g… 2024-07-05… \"Envir…\n# ℹ 90 more rows"
  }
]